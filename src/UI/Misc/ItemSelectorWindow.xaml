<Window x:Class="LoneEftDmaRadar.UI.Misc.ItemSelectorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:LoneEftDmaRadar.UI.Misc"
        xmlns:vm="clr-namespace:LoneEftDmaRadar.UI.Misc"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Select Item"
        Width="600"
        Height="600"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        FocusManager.FocusedElement="{Binding ElementName=SearchTextBox}"
        Icon="/lone-icon.ico">
    <d:Window.DataContext>
        <d:DesignInstance Type="{x:Type vm:ItemSelectorViewModel}"
                      IsDesignTimeCreatable="False"/>
    </d:Window.DataContext>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Search Box -->
        <StackPanel Grid.Row="0" Margin="0,0,0,10">
            <TextBlock Text="Search:" Margin="0,0,0,5"/>
            <TextBox x:Name="SearchTextBox"
                     Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                     Margin="0,0,0,5"
                     Padding="5"/>
            <TextBlock Text="{Binding FilteredItems.Count, StringFormat='Found: {0} items'}"
                       Foreground="Gray"
                       FontSize="11"/>
        </StackPanel>

        <!-- Items List -->
        <ListView Grid.Row="1"
                  ItemsSource="{Binding FilteredItems}"
                  SelectedItem="{Binding SelectedItem, Mode=TwoWay}"
                  MouseDoubleClick="ListView_MouseDoubleClick"
                  VirtualizingStackPanel.IsVirtualizing="True"
                  VirtualizingStackPanel.VirtualizationMode="Recycling"
                  ScrollViewer.CanContentScroll="True">
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="Name" Width="300">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Name}" TextWrapping="Wrap"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="ID" Width="250">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding BsgId}" FontFamily="Consolas" FontSize="10"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView>

        <!-- Buttons -->
        <StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,10,0,0">
            <Button x:Name="OkButton"
                    Content="OK"
                    Width="75"
                    Margin="5,0"
                    IsDefault="True"
                    Command="{Binding OkCommand}"
                    IsEnabled="{Binding HasSelection}"/>
            <Button x:Name="CancelButton"
                    Content="Cancel"
                    Width="75"
                    Margin="5,0"
                    IsCancel="True"
                    Command="{Binding CancelCommand}"/>
        </StackPanel>
    </Grid>
</Window>

